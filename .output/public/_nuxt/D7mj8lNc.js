import{_ as Z,q as J,I as P,K as v,L as Q,l as r,M as X,N as z,o as s,c as d,a as N,F as O,W as E,U as T,S as Y,H as S,R as D,b as c,f as K,r as M,w as j,a7 as x,u as l,i as ee,$ as G,h as te,k as ae,Z as ne}from"./Df1knQT9.js";import{u as le,b as ie,_ as R,a as oe}from"./CLSmJRx7.js";import{g as B}from"./xzbAO19n.js";import{_ as re}from"./DFYkVTat.js";import{z as $}from"./DXqQCM1T.js";import{a as L,b as se}from"./BQaAxLrp.js";import{u as ue}from"./nvnfJ7aK.js";import{u as de}from"./DnlTnJ3C.js";import"./CPustXx-.js";const ce=J({components:{UIcon:P},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>v.ui.input.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>v.ui.select.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:()=>v.ui.select.default.size,validator(e){return Object.keys(v.ui.select.size).includes(e)}},color:{type:String,default:()=>v.ui.select.default.color,validator(e){return[...v.ui.colors,...Object.keys(v.ui.select.color)].includes(e)}},variant:{type:String,default:()=>v.ui.select.default.variant,validator(e){return[...Object.keys(v.ui.select.variant),...Object.values(v.ui.select.color).flatMap(i=>Object.keys(i))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},ui:{type:Object,default:()=>v.ui.select}},emits:["update:modelValue","change"],setup(e,{emit:i,slots:f}){const y=Q(),t=r(()=>X({},e.ui,y.ui.select)),{emitFormBlur:b}=le(),p=n=>{i("update:modelValue",n.target.value)},a=n=>{b(),i("change",n)},u=n=>B(n,e.valueAttribute,B(n,e.optionAttribute)),o=n=>B(n,e.optionAttribute,B(n,e.valueAttribute)),C=n=>["string","number","boolean"].includes(typeof n)?{[e.valueAttribute]:n,[e.optionAttribute]:n}:{...n,[e.valueAttribute]:u(n),[e.optionAttribute]:o(n)},A=r(()=>e.options.map(n=>C(n))),g=r(()=>e.placeholder?[{[e.valueAttribute]:"",[e.optionAttribute]:e.placeholder,disabled:!0},...A.value]:A.value),V=r(()=>{const n=C(e.modelValue),w=g.value.find(U=>U[e.valueAttribute]===n[e.valueAttribute]);return w?w[e.valueAttribute]:""}),I=r(()=>{var w,U;const n=((U=(w=t.value.color)==null?void 0:w[e.color])==null?void 0:U[e.variant])||t.value.variant[e.variant];return z(t.value.base,t.value.rounded,t.value.size[e.size],e.padded?t.value.padding[e.size]:"p-0",n==null?void 0:n.replaceAll("{color}",e.color),(m.value||f.leading)&&t.value.leading.padding[e.size],(_.value||f.trailing)&&t.value.trailing.padding[e.size])}),m=r(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),_=r(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),k=r(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),q=r(()=>e.loading&&!m.value?e.loadingIcon:e.trailingIcon||e.icon),F=r(()=>z(t.value.icon.leading.wrapper,t.value.icon.leading.pointer,t.value.icon.leading.padding[e.size])),W=r(()=>z(t.value.icon.base,y.ui.colors.includes(e.color)&&t.value.icon.color.replaceAll("{color}",e.color),t.value.icon.size[e.size],e.loading&&"animate-spin")),h=r(()=>z(t.value.icon.trailing.wrapper,t.value.icon.trailing.pointer,t.value.icon.trailing.padding[e.size])),H=r(()=>z(t.value.icon.base,y.ui.colors.includes(e.color)&&t.value.icon.color.replaceAll("{color}",e.color),t.value.icon.size[e.size],e.loading&&!m.value&&"animate-spin"));return{ui:t,normalizedOptionsWithPlaceholder:g,normalizedValue:V,isLeading:m,isTrailing:_,selectClass:I,leadingIconName:k,leadingIconClass:W,leadingWrapperIconClass:F,trailingIconName:q,trailingIconClass:H,trailingWrapperIconClass:h,onInput:p,onChange:a}}}),ge=["id","name","value","required","disabled"],me=["value","label"],ve=["value","selected","disabled","textContent"],be=["value","selected","disabled","textContent"];function fe(e,i,f,y,t,b){const p=P;return s(),d("div",{class:S(e.ui.wrapper)},[N("select",Y({id:e.name,name:e.name,value:e.modelValue,required:e.required,disabled:e.disabled||e.loading,class:["form-select",e.selectClass]},e.$attrs,{onInput:i[0]||(i[0]=(...a)=>e.onInput&&e.onInput(...a)),onChange:i[1]||(i[1]=(...a)=>e.onChange&&e.onChange(...a))}),[(s(!0),d(O,null,E(e.normalizedOptionsWithPlaceholder,(a,u)=>(s(),d(O,null,[a.children?(s(),d("optgroup",{key:`${a[e.valueAttribute]}-optgroup-${u}`,value:a[e.valueAttribute],label:a[e.optionAttribute]},[(s(!0),d(O,null,E(a.children,(o,C)=>(s(),d("option",{key:`${o[e.valueAttribute]}-${u}-${C}`,value:o[e.valueAttribute],selected:o[e.valueAttribute]===e.normalizedValue,disabled:o.disabled,textContent:T(o[e.optionAttribute])},null,8,ve))),128))],8,me)):(s(),d("option",{key:`${a[e.valueAttribute]}-${u}`,value:a[e.valueAttribute],selected:a[e.valueAttribute]===e.normalizedValue,disabled:a.disabled,textContent:T(a[e.optionAttribute])},null,8,be))],64))),256))],16,ge),e.isLeading&&e.leadingIconName||e.$slots.leading?(s(),d("span",{key:0,class:S(e.leadingWrapperIconClass)},[D(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[c(p,{name:e.leadingIconName,class:S(e.leadingIconClass)},null,8,["name","class"])])],2)):K("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(s(),d("span",{key:1,class:S(e.trailingWrapperIconClass)},[D(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[c(p,{name:e.trailingIconName,class:S(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])])],2)):K("",!0)],2)}const ye=Z(ce,[["render",fe]]),pe={class:"flex gap-2 items-start"},Ce={class:"mt-4 space-y-2"},Ae={__name:"CategoryInput",props:{categories:{type:Array,required:!0},initialCategories:{type:Array,required:!0}},emits:["update:categories"],setup(e,{emit:i}){const f=e,y=i,t=M(""),b=()=>{if(!t.value)return;const a=[...f.categories,t.value];y("update:categories",a),t.value=""},p=a=>{const u=f.categories.filter(o=>o!==a);y("update:categories",u)};return(a,u)=>{const o=ie,C=R,A=G;return s(),d("div",null,[N("div",pe,[c(C,{label:"Expense categories",name:"newCategory",class:"flex-1"},{default:j(()=>[c(o,{type:"text",placeholder:"Add new category...",onKeyup:x(b,["enter"]),modelValue:l(t),"onUpdate:modelValue":u[0]||(u[0]=g=>ee(t)?t.value=g:null),clearable:""},null,8,["modelValue"])]),_:1}),c(A,{class:"mt-7",onClick:b,color:"primary",size:"md",label:"Add",disabled:!l(t)},null,8,["disabled"])]),N("div",Ce,[(s(!0),d(O,null,E(e.categories,g=>(s(),d("div",{key:g,class:"flex items-center justify-between p-1 rounded border"},[N("span",null,T(g),1),c(A,{size:"sm",color:"red",variant:"soft",icon:"i-heroicons-trash",onClick:V=>p(g),title:"Delete category"},null,8,["onClick"])]))),128))])])}}},Ue={__name:"settings",setup(e){var C,A,g,V;const i=ue(),f=te(),{toastSuccess:y,toastError:t}=oe(),b=M(!1),{categoryList:p}=de(),a=M({transactionView:((A=(C=f.value)==null?void 0:C.user_metadata)==null?void 0:A.transaction_view)??L[1],currency:((V=(g=f.value)==null?void 0:g.user_metadata)==null?void 0:V.currency)??"USD",categories:p.value}),u=$.object({transactionView:$.enum(L),currency:$.string(),categories:$.array($.string())}),o=async()=>{b.value=!0;try{const{error:I}=await i.auth.updateUser({data:{transaction_view:a.value.transactionView,currency:a.value.currency,categories:a.value.categories}});if(I)throw I;y({title:"Settings updated"})}catch(I){t({title:"Error updating settings",description:I.message})}finally{b.value=!1}};return(I,m)=>{const _=ye,k=R,q=Ae,F=G,W=re;return s(),ae(W,{state:l(a),schema:l(u),onSubmit:ne(o,["prevent"])},{default:j(()=>[c(k,{label:"Transaction View",class:"mb-4",help:"Choose how you would like to view transactions"},{default:j(()=>[c(_,{modelValue:l(a).transactionView,"onUpdate:modelValue":m[0]||(m[0]=h=>l(a).transactionView=h),options:l(L)},null,8,["modelValue","options"])]),_:1}),c(k,{label:"Currency",class:"mb-4",help:"Choose the currency you would like to use"},{default:j(()=>[c(_,{modelValue:l(a).currency,"onUpdate:modelValue":m[1]||(m[1]=h=>l(a).currency=h),options:l(se)},null,8,["modelValue","options"])]),_:1}),c(q,{categories:l(a).categories,"onUpdate:categories":m[2]||(m[2]=h=>l(a).categories=h),"initial-categories":l(p)},null,8,["categories","initial-categories"]),c(F,{class:"mt-4",type:"submit",color:"black",variant:"solid",label:"Save",loading:l(b),disabled:l(b)},null,8,["loading","disabled"])]),_:1},8,["state","schema"])}}};export{Ue as default};
