import{_ as z}from"./7p6lLr2F.js";import{b as D,_ as B,a as L}from"./D0wLo8BB.js";import{r as U,o as f,c as C,a as h,b as a,w as v,ad as $,u as t,i as j,F as q,Y as G,W as K,a2 as A,h as N,l as O,a3 as T}from"./CBLPEO5m.js";import{_ as M}from"./CsibLXRn.js";import{z as d}from"./DXqQCM1T.js";import{a as x,b as R}from"./BQaAxLrp.js";import{u as W}from"./08lz3Hdw.js";import{u as Y}from"./4_LvFyBa.js";import"./5BPea2Hp.js";import"./A4Xj3Y_T.js";const H={class:"flex gap-2 items-start"},J={class:"mt-4 space-y-2"},P={__name:"CategoryInput",props:{categories:{type:Array,required:!0},initialCategories:{type:Array,required:!0}},emits:["update:categories"],setup(b,{emit:w}){const c=b,_=w,o=U(""),n=()=>{if(!o.value)return;const e=[...c.categories,o.value];_("update:categories",e),o.value=""},g=e=>{const r=c.categories.filter(l=>l!==e);_("update:categories",r)};return(e,r)=>{const l=D,y=B,u=A;return f(),C("div",null,[h("div",H,[a(y,{label:"Expense categories",name:"newCategory",class:"flex-1"},{default:v(()=>[a(l,{type:"text",placeholder:"Add new category...",onKeyup:$(n,["enter"]),modelValue:t(o),"onUpdate:modelValue":r[0]||(r[0]=s=>j(o)?o.value=s:null),clearable:""},null,8,["modelValue"])]),_:1}),a(u,{class:"mt-7",onClick:n,color:"primary",size:"md",label:"Add",disabled:!t(o)},null,8,["disabled"])]),h("div",J,[(f(!0),C(q,null,G(b.categories,s=>(f(),C("div",{key:s,class:"flex items-center justify-between p-1 rounded border"},[h("span",null,K(s),1),a(u,{size:"sm",color:"red",variant:"soft",icon:"i-heroicons-trash",onClick:V=>g(s),title:"Delete category"},null,8,["onClick"])]))),128))])])}}},ie={__name:"settings",setup(b){var y,u,s,V;const w=W(),c=N(),{toastSuccess:_,toastError:o}=L(),n=U(!1),{categoryList:g}=Y(),e=U({transactionView:((u=(y=c.value)==null?void 0:y.user_metadata)==null?void 0:u.transaction_view)??x[1],currency:((V=(s=c.value)==null?void 0:s.user_metadata)==null?void 0:V.currency)??"USD",categories:g.value}),r=d.object({transactionView:d.enum(x),currency:d.string(),categories:d.array(d.string())}),l=async()=>{n.value=!0;try{const{error:p}=await w.auth.updateUser({data:{transaction_view:e.value.transactionView,currency:e.value.currency,categories:e.value.categories}});if(p)throw p;_({title:"Settings updated"})}catch(p){o({title:"Error updating settings",description:p.message})}finally{n.value=!1}};return(p,i)=>{const k=z,S=B,F=P,I=A,E=M;return f(),O(E,{state:t(e),schema:t(r),onSubmit:T(l,["prevent"])},{default:v(()=>[a(S,{label:"Transaction View",class:"mb-4",help:"Choose how you would like to view transactions"},{default:v(()=>[a(k,{modelValue:t(e).transactionView,"onUpdate:modelValue":i[0]||(i[0]=m=>t(e).transactionView=m),options:t(x)},null,8,["modelValue","options"])]),_:1}),a(S,{label:"Currency",class:"mb-4",help:"Choose the currency you would like to use"},{default:v(()=>[a(k,{modelValue:t(e).currency,"onUpdate:modelValue":i[1]||(i[1]=m=>t(e).currency=m),options:t(R)},null,8,["modelValue","options"])]),_:1}),a(F,{categories:t(e).categories,"onUpdate:categories":i[2]||(i[2]=m=>t(e).categories=m),"initial-categories":t(g)},null,8,["categories","initial-categories"]),a(I,{class:"mt-4",type:"submit",color:"black",variant:"solid",label:"Save",loading:t(n),disabled:t(n)},null,8,["loading","disabled"])]),_:1},8,["state","schema"])}}};export{ie as default};
